<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>i7protocol ‚Äî Portafolio</title>
  <meta name="description" content="Portafolio sincronizado con los repositorios p√∫blicos de GitHub del usuario i7protocol." />
  <link rel="preconnect" href="https://avatars.githubusercontent.com" crossorigin>
  <style>
    :root{
      --bg: #0b0d10;
      --panel: #10131a;
      --text: #e9eef3;
      --muted: #9aa7b3;
      --brand: #7aa2ff;
      --accent: #52e0a8;
      --warn: #ffcc66;
      --danger: #ff6b6b;
      --border: #1b2230;
      --shadow: 0 6px 24px rgba(0,0,0,.35), 0 2px 8px rgba(0,0,0,.25);
    }
    :root.light{
      --bg: #f7f9fc;
      --panel: #ffffff;
      --text: #0d1b2a;
      --muted: #415a77;
      --brand: #3954ff;
      --accent: #00a67d;
      --warn: #b08900;
      --danger: #c92a2a;
      --border: #e6ecf5;
      --shadow: 0 6px 24px rgba(0,0,0,.08), 0 2px 8px rgba(0,0,0,.05);
    }
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      background: var(--bg); color: var(--text);
    }
    .container{max-width:1100px;margin:0 auto;padding:24px}
    header{
      display:grid; grid-template-columns: 96px 1fr auto; gap:16px; align-items:center;
      background: var(--panel); border:1px solid var(--border); border-radius:20px; padding:16px; box-shadow: var(--shadow);
      position: sticky; top: 16px; z-index: 10;
    }
    header img{width:96px;height:96px;border-radius:16px;border:1px solid var(--border);object-fit:cover}
    .title h1{font-size: clamp(22px, 2.6vw, 32px); margin:0 0 6px}
    .title p{margin:0;color:var(--muted)}
    .actions{display:flex;gap:10px;align-items:center}
    button, .link-btn{
      appearance:none; border:1px solid var(--border); background: var(--panel); color:var(--text);
      padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:600; transition:.2s transform, .2s opacity, .2s background;
      box-shadow: var(--shadow);
    }
    button:hover, .link-btn:hover{transform: translateY(-1px)}
    .link-btn{display:inline-flex;gap:8px;align-items:center;text-decoration:none}

    .toolbar{display:flex;flex-wrap:wrap;gap:12px;margin:18px 0}
    .toolbar input, .toolbar select{
      background: var(--panel); color: var(--text); border:1px solid var(--border);
      padding:10px 12px; border-radius:12px; min-width: 200px;
    }

    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px}
    .card{
      background: var(--panel); border:1px solid var(--border); border-radius:18px; padding:16px; box-shadow: var(--shadow);
      display:flex; flex-direction:column; min-height: 170px;
    }
    .card h3{margin:0 0 8px; font-size: 18px}
    .desc{color:var(--muted); font-size:14px; line-height:1.4; margin-bottom:10px}
    .meta{display:flex; gap:8px; flex-wrap:wrap; margin-top:auto}
    .badge{font-size:12px; padding:6px 8px; border-radius:999px; border:1px solid var(--border); background:rgba(122,162,255,.08)}
    .badge.star{background:rgba(255,215,0,.08)}
    .badge.lang{background:rgba(82,224,168,.10)}
    .badge.updated{background:rgba(57,84,255,.08)}

    .skeleton{position:relative;overflow:hidden}
    .skeleton::after{
      content:""; position:absolute; inset:0; background:linear-gradient(90deg, transparent, rgba(255,255,255,.06), transparent);
      animation: shine 1.3s infinite;
    }
    @keyframes shine{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}

    .footer{margin:28px 0 16px; color:var(--muted); text-align:center; font-size:13px}
    .pill{display:inline-flex; gap:6px; align-items:center; padding:6px 10px; border-radius:999px; border:1px solid var(--border)}
    .hidden{display:none !important}
    .error{padding:14px; border:1px solid var(--danger); background: #2a1111; color:#ffd7d7; border-radius:12px}
    .empty{padding:18px; text-align:center; color:var(--muted)}

    @media (max-width:720px){
      header{grid-template-columns:72px 1fr auto}
      header img{width:72px;height:72px}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <img id="avatar" alt="Avatar de GitHub" class="skeleton" />
      <div class="title">
        <h1 id="name" class="skeleton">i7protocol</h1>
        <p id="bio" class="skeleton">Cargando bio...</p>
        
        <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap">$1</div>
        
      </div>
      <div class="actions">
        <a id="ghLink" class="link-btn" href="https://github.com/i7protocol" target="_blank" rel="noopener">Visitar GitHub</a>
        <button id="themeBtn" title="Cambiar tema" aria-label="Cambiar tema">üåó</button>
      </div>
    </header>

    <section class="toolbar" aria-label="Herramientas de filtrado y orden">
      <input id="search" type="search" placeholder="Buscar proyecto por nombre o descripci√≥n" />
      <select id="langFilter">
        <option value="">Todas las tecnolog√≠as</option>
      </select>
      <select id="sort">
        <option value="updated">Orden: actualizados</option>
        <option value="stars">Orden: estrellas</option>
        <option value="name">Orden: nombre</option>
      </select>
      <span id="count" class="pill">0 proyectos</span>
    </section>

    <p class="mini" style="margin:32px 0 12px; font-size:18px; font-weight:600;">Hola, estos son mis proyectos.</p>

    <section id="projects" class="grid" aria-live="polite" aria-busy="true"></section>

    <div id="empty" class="empty hidden">No hay proyectos que coincidan con el filtro. Prob√° quitar filtros o revisar que el usuario tenga repos p√∫blicos.</div>
    <div id="error" class="error hidden"></div>

    <p class="footer">Hecho con HTML, CSS y JavaScript. Datos tra√≠dos en vivo desde la API p√∫blica de GitHub.</p>
  </div>

  <script>
    // ===================== CONFIG =====================
    const GITHUB_USER = 'i7protocol'; // cambi√° esto si quer√©s otro usuario
    const MAX_REPOS = 100;            // hasta 100 por p√°gina en API p√∫blica

    // ===================== THEME =====================
    const root = document.documentElement;
    const themeBtn = document.getElementById('themeBtn');
    const saved = localStorage.getItem('theme') || 'dark';
    if (saved === 'light') root.classList.add('light');
    themeBtn.addEventListener('click', () => {
      root.classList.toggle('light');
      localStorage.setItem('theme', root.classList.contains('light') ? 'light' : 'dark');
    });

    // ===================== DOM REFS =====================
    const projectsEl = document.getElementById('projects');
    const nameEl = document.getElementById('name');
    const bioEl = document.getElementById('bio');
    const avatarEl = document.getElementById('avatar');
    const statsEl = document.getElementById('stats');
    const ghLinkEl = document.getElementById('ghLink');
    const searchEl = document.getElementById('search');
    const langFilterEl = document.getElementById('langFilter');
    const sortEl = document.getElementById('sort');
    const countEl = document.getElementById('count');
    const errorEl = document.getElementById('error');
    const emptyEl = document.getElementById('empty');

    // ===================== STATE =====================
    let repos = [];
    let languages = new Set();

    // ===================== HELPERS =====================
    const fmt = new Intl.DateTimeFormat('es-UY', { dateStyle: 'medium' });
    const plural = (n, s, p) => n === 1 ? s : p;

    function skeletonOff(){
      [nameEl,bioEl,avatarEl,statsEl].forEach(el=>el.classList.remove('skeleton'))
    }

    function badge(text, cls=''){
      const span = document.createElement('span');
      span.className = `badge ${cls}`.trim();
      span.textContent = text;
      return span;
    }

    function normalize(str){
      return (str || '').toLowerCase();
    }

    function applyFilters(){
      const q = normalize(searchEl.value);
      const lang = langFilterEl.value;
      let list = repos.slice();

      if (q) {
        list = list.filter(r => normalize(r.name).includes(q) || normalize(r.description).includes(q));
      }
      if (lang) {
        list = list.filter(r => r.language === lang);
      }

      const sort = sortEl.value;
      if (sort === 'updated') list.sort((a,b)=> new Date(b.pushed_at) - new Date(a.pushed_at));
      if (sort === 'stars') list.sort((a,b)=> (b.stargazers_count||0)-(a.stargazers_count||0));
      if (sort === 'name') list.sort((a,b)=> a.name.localeCompare(b.name));

      render(list);
    }

    function render(list){
      projectsEl.innerHTML = '';
      countEl.textContent = `${list.length} ${plural(list.length,'proyecto','proyectos')}`;
      emptyEl.classList.toggle('hidden', list.length !== 0);
      projectsEl.setAttribute('aria-busy', String(list.length === 0));

      list.forEach(r => {
        const card = document.createElement('article');
        card.className = 'card';
        const title = document.createElement('h3');
        const link = document.createElement('a');
        link.href = r.html_url; link.target = '_blank'; link.rel = 'noopener';
        link.textContent = r.name;
        link.style.textDecoration = 'none';
        link.style.color = 'var(--text)';
        title.appendChild(link);

        const desc = document.createElement('p');
        desc.className = 'desc';
        desc.textContent = r.description || 'Sin descripci√≥n';

        const meta = document.createElement('div');
        meta.className = 'meta';
        if (r.stargazers_count) meta.appendChild(badge(`‚òÖ ${r.stargazers_count}`, 'star'));
        if (r.language) meta.appendChild(badge(r.language, 'lang'));
        meta.appendChild(badge(`Actualizado: ${fmt.format(new Date(r.pushed_at))}`, 'updated'));
        if (r.homepage) {
          const site = document.createElement('a');
          site.href = r.homepage; site.target = '_blank'; site.rel = 'noopener';
          site.className = 'badge'; site.textContent = 'Demo';
          meta.appendChild(site);
        }

        card.appendChild(title);
        card.appendChild(desc);
        card.appendChild(meta);
        projectsEl.appendChild(card);
      });
    }

    // ===================== FETCH =====================
    async function fetchJSON(url){
      const res = await fetch(url, { headers: { 'Accept': 'application/vnd.github+json' } });
      if (!res.ok) throw new Error(`HTTP ${res.status} al pedir ${url}`);
      return res.json();
    }

    async function load(){
      try {
        // Perfil
        const user = await fetchJSON(`https://api.github.com/users/${GITHUB_USER}`);
        nameEl.textContent = user.name || user.login;
        bioEl.textContent = user.bio || 'Sin bio';
        avatarEl.src = "https://media1.tenor.com/m/DGtrV4rsm3MAAAAd/chainsaw-man-denji.gif";
        avatarEl.alt = `Avatar de ${user.login}`;
        ghLinkEl.href = user.html_url;
        statsEl.textContent = `${user.public_repos} repos ‚Ä¢ ${user.followers} seguidores ‚Ä¢ ${user.following} siguiendo`;
        skeletonOff();

        // Repos (no forks, no archived)
        const raw = await fetchJSON(`https://api.github.com/users/${GITHUB_USER}/repos?per_page=${MAX_REPOS}&sort=updated`);
        repos = raw.filter(r => !r.fork && !r.archived);

        // Lenguajes √∫nicos
        repos.forEach(r => { if (r.language) languages.add(r.language); });
        [...languages].sort().forEach(l => {
          const opt = document.createElement('option');
          opt.value = l; opt.textContent = l; langFilterEl.appendChild(opt);
        });

        applyFilters();
      } catch (err) {
        console.error(err);
        errorEl.textContent = `No pude cargar datos p√∫blicos de GitHub. Detalle: ${err.message}`;
        errorEl.classList.remove('hidden');
      }
    }

    // ===================== EVENTS =====================
    searchEl.addEventListener('input', applyFilters);
    langFilterEl.addEventListener('change', applyFilters);
    sortEl.addEventListener('change', applyFilters);

    // Inicio
    load();
  </script>
</body>
</html>
